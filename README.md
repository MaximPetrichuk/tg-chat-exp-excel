# Telegram Chat Exporter to Excel file
Клиент командной строки Telegram для экспорта содержимого чата в фвйл Excel за указанный период времени.

Этот проект реализует экспорт сообщений из Telegram-чата в файл Excel (.xlsx) за указанный месяц единым списком, а так же с разбивкой на топики - каждый топик сохранятся на отдельном листе.

## Структура проекта

- `.env.example` — пример файла с переменными окружения
- `requirements.txt` — зависимости
- `README.md` — инструкция по запуску

## Внешние зависимости
- `telethon`
- `openpyxl`
- `python-dotenv`

## Требуется

- Python 3.7+
- Аккаунт Telegram
- Подключение к Telegram API

## 1. Подключение к Telegram API

1. Зайти на https://my.telegram.org
2. Войди под своим номером, далее → API development tools
3. Создай приложение и получить api_id и api_hash.

## 2. Клонирование и подготовка

1. Склонируйте репозиторий и перейдите в папку проекта:
   ```sh
   cd путь_к_проекту
   ```

2. Создайте виртуальное окружение (например, с помощью venv):
   ```sh
   python -m venv venv
   ```

3. Активируйте виртуальное окружение:
   - **Windows:**
     ```sh
     .\venv\Scripts\activate
     ```
   - **Linux/macOS:**
     ```sh
     source venv/bin/activate
     ```
   После этого окружение будет активировано и слева командной строки появится (venv).

4. Установите зависимости:
   ```sh
   pip install -r requirements.txt
   ```

5. Скопируйте `.env.example` в `.env` и укажите там свои api_id и api_hash, а так же номер телефона. (Никому не сообщейте и не передавайте эти данные!)

## 3. Запуск

```sh
python tg-chat-exp-excel.py
```
При первом запуске программа спросит ваш номер телефона, код - который придет в приложении Telegram, а так же пароль в приложении Telegram, после чего информации о подключении будет сохранена в файл tg-chat-exp-excel.session
Так же программа сообщит, что не найден чат с ID -100 и выдаст список доступных чатов. Из этого списка нужно выбрать чат для экспорта и прописать его ID в файле .env

## 4. Деактивация виртуального окружения

```sh
deactivate
```
---

- Все зависимости устанавливаются только внутри виртуального окружения.
- Не устанавливайте пакеты глобально!
- Для каждого нового терминала не забывайте активировать окружение.

### Лицинзия
MIT.
